# (Full Metric_calculation.py content from previous response goes here)
# For brevity, this placeholder is used to simulate file recreation.